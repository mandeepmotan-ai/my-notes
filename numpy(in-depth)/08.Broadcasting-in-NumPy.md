# Broadcasting in NumPy

**Broadcasting** is a powerful mechanism that allows NumPy to perform arithmetic operations on arrays with different shapes. It "stretches" the smaller array over the larger one without making unnecessary copies of data in memory.

### 1. The Core Rules

To determine if two arrays are compatible for broadcasting, NumPy compares their shapes element-wise, starting from the **rightmost (trailing) dimensions**.

1. **Dimension Alignment:** If arrays have a different number of dimensions, prepend the shape of the smaller array with 1s until both have the same length.
2. **Size Compatibility:** Two dimensions are compatible if:
    - They are **equal**, OR
    - One of them is **1**.
3. **Stretch Rule:** Dimensions with size 1 are "stretched" or copied to match the larger dimension. If sizes differ and neither is 1, broadcasting fails and raises a `ValueError`.

---

### 2. Broadcasting Examples & Logic

### Case 1: Successful Broadcasting (1D to 2D)

- **Array A:** (4, 3)
- **Array B:** (3,)→ Becomes (1, 3)
- **Logic:** The 1 in (1, 3) is stretched to match the 4. Result shape: (4, 3).

```python
a = np.arange(12).reshape(4,3)
b = np.arange(3)
print(a + b) # Works!
```

### Case 2: The "Mismatch" Error

- **Array A:** (3, 4)
- **Array B:** (3,)→ Becomes (1, 3)
- **Logic:** Comparing trailing dimensions: 4 vs 3. Neither is 1, and they aren't equal.

```python
a = np.arange(12).reshape(3,4)
b = np.arange(3)
# print(a + b) # ERROR: operands could not be broadcast together
```

### Case 3: Stretching Both Arrays (Row & Column Vector)

- **Array A:** (1, 3)
- **Array B:** (3, 1)
- **Logic:** A stretches its columns, B stretches its rows. Result shape: (3, 3).

```python
a = np.arange(3).reshape(1,3)
b = np.arange(3).reshape(3,1)
print(a + b) # Works! Result is 3x3
```

### Case 4: Scalar to Matrix

- **Array A:** (1,)→ Becomes (1, 1)
- **Array B:** (2, 2)
- **Logic:** The single value is broadcast across all rows and columns.

```python
a = np.array([1])
b = np.arange(4).reshape(2,2)
print(a + b) # Works!
```

### 3. Comparison Cheat Sheet for Notion

| **Array A Shape** | **Array B Shape** | **Will it Broadcast?** | **Resulting Shape** |
| --- | --- | --- | --- |
| `(4, 3)` | `(3,)` | ✅ Yes | `(4, 3)` |
| `(3, 4)` | `(3,)` | ❌ No | Error |
| `(1, 3)` | `(4, 1)` | ✅ Yes | `(4, 3)` |
| `(3, 4)` | `(4, 3)` | ❌ No | Error |
| `(4, 4)` | `(2, 2)` | ❌ No | Error |